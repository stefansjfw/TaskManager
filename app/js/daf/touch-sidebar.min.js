/*!
* Touch UI - Sidebar 2.0
* Copyright 2024 Code On Time LLC; Licensed MIT; http://codeontime.com/license
*/
(function(){function a(){var n=$(".app-sidebar").first();l().attr("data-draggable","sidebar-resizer").insertAfter(n);e(n)}function f(){return Math.round(n.screen().width/2)}function r(t){var r=__settings.bars.left,f;r.defaultWidth=t;r.animate=!1;n.sidebar("toggle",u==t);f=r.mini;f?r.defaultWidth=n.sidebar("defaultWidth"):(i.userVar("sidebar.width",t),n.settings("ui.sidebar.width"));n.settings("ui.sidebar.mini",f);i.userVar("minisidebar",f);r.animate=!0}function e(n){var t,i;n||(n=$(".app-sidebar").first());n.length&&(t=__settings.bars.left,!t.mini&&t.width>f()?r(f()):(i=c(n),$('[data-draggable="sidebar-resizer"]').css({top:i.top,left:i.right-4,height:i.height})),n.find(".app-treeview").toggleClass("app-treeview-hidden",t.mini===!0))}function o(){return(n.settings("ui.menu.style")||"tree")==="tree"}function v(t){for(var f={nodes:{},type:"sitemap"},h=f,e=0,c=0,l=n.settings("ui.menu.autoExpand")||"current",i,r,s,u,a,o,v;e<t.length;){if(i=t[e],r={text:i.text,name:"n"+e,sitemap:{context:i.context,callback:i.callback}},i.icon&&(c++,r.icon=i.icon),i.tooltip&&(r.tooltip=i.tooltip),f.nodes[r.name]=r,r.parent=f,i.selected){for(s=[],u=r;u&&u.name;)s.splice(0,0,u.name),u=u.parent;u.path=s.join("/");l=="current"&&(r.expanded=!0)}if(e++,e<t.length)if(a=t[e],o=a.depth,o>i.depth)r.nodes||(r.nodes={}),l=="all"&&(r.expanded=!0),f=r;else if(o<i.depth)for(v=i.depth;o<v--;)f=f.parent}return h.icons=c>0,h}var i=$app,y=i.input,n=i.touch,s=$(document),h=Web.DataViewResources,p=h.Data.BooleanDefaultItems,c=i.clientRect,u=56,t=i.html,w=t.tag,b=t.div,k=t.span,d=t.$tag,g=t.$p,l=t.$div,nt=t.$span,tt=t.$a,it=t.$i,rt=t.$li,ut=t.$ul;n.sideBar=function(t,i,r){function u(){a();n.sideBar.ready=!0;r()}r&&(o()?n.treeView().then(u):u())};i.dragMan["sidebar-resizer"]={options:{taphold:!1,immediate:!1},start:function(t){var r=this,e=t.target,o=i.clientRect(e),s;t.dir="all";r._target=e;e.addClass("app-dragging");s=r._sidebar=e.closest(".app-sidebar");r._location="left";r._width=s.width();r._availWidth=n.screen().width;r._minX=n.screen().left+u;r._maxX=n.screen().left+f();r._deltaX=o.left-t.x+(r._location==="left"?o.width:0)},move:function(t){var i=this,r=Math.round(t.x+i._deltaX),u;r<i._minX&&(r=i._minX);r>i._maxX&&(r=i._maxX);u=r-n.screen().left;u!=i._newWidth&&i._position(u)},cancel:function(){var n=this;n._width!=null&&n._position(n._width);n._target.removeClass("app-dragging");delete n._target;delete n._sidebar},end:function(){var n=this;delete n._width;n.cancel()},_position:function(n){var t=this;t._newWidth=n;r(n)}};s.on("dblclick",'[data-draggable="sidebar-resizer"]',()=>{var t=__settings.bars.left,i=n.sidebar("defaultWidth");return t.mini||t.defaultWidth!=i?r(i):r(u),!1}).on("resized.app",()=>{e()}).on("beforesidebarpanelshow.app",t=>{var e,u;if(o()){for(var i=t.panel.items,f=[],r=0;r<i.length;)i[r].depth?(f.push(i[r]),i.splice(r,1)):r++;while(i.length&&i[0].text==null)i.splice(0,1);f.length&&!t.panel.elem.find(".app-treeview").length&&(e=t.panel.elem.find(".ui-listview"),u=v(f),n.settings("ui.menu.position")==="bottom"?u.after=e:u.before=e,n.treeView(u),t.panel.elem.find(".app-treeview").data("originalPath",u.path))}}).on("treeview.app",n=>{var t=n.treeView;t.hierarchy==="sitemap"&&t.eventName==="select"&&t.treeView.data("originalPath")!=t.nodePath&&t.node.sitemap.callback(t.node.sitemap.context)}).on("menuchanged.app",function(){$(".app-sidebar .app-treeview").remove()})})()